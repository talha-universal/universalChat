<!-- [ngClass]="{'boxheight':!isKeyboardMbl,'mblKeyboardBlur':isKeyboardMbl}" -->
<div [class.active]="isVisible" class="chatBox notranslate" id="checkBox">

    <div class="header" [ngClass]="{'headerTop':!isKeyboardMbl,'':isKeyboardMbl}">
        <div class="logo">
            <span><img class="logoImg" /> </span>
            <span class="userName">
                <span>{{loginData.aId ? loginData?.aId:'AGENT'}}</span>
                <span class="supporterStatus">{{loginData.aId ? 'Online' : ''}}</span>
            </span>
        </div>
        <div class="d-flex">
            <!-- <span class="callIcon me-3
            ">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                    id="OBJECTS" x="0px" y="0px" viewBox="0 0 50 50" enable-background="new 0 0 50 50"
                    xml:space="preserve">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M38.683,48.593c-5.663-0.032-10.869-1.672-15.753-4.463  c-4.831-2.76-8.902-6.416-12.543-10.584c-2.639-3.021-4.974-6.252-6.816-9.83c-1.789-3.473-3.037-7.107-3.493-11.004  c-0.224-1.919,0.193-3.629,1.552-5.027c1.596-1.642,3.191-3.292,4.879-4.837c1.83-1.674,4.305-1.871,6.5-0.696  c0.814,0.436,1.465,1.045,2.012,1.775c1.122,1.501,2.256,2.993,3.356,4.51c1.371,1.891,1.623,3.926,0.576,6.036  c-0.296,0.595-0.735,1.166-1.236,1.603c-1.063,0.926-1.22,2.05-0.957,3.324c0.344,1.672,1.19,3.106,2.195,4.442  c2.09,2.777,4.506,5.242,7.314,7.3c1.392,1.021,2.859,1.937,4.597,2.246c0.563,0.102,1.17,0.118,1.729,0.02  c0.421-0.075,0.842-0.343,1.186-0.62c0.679-0.547,1.242-1.253,1.962-1.729c1.879-1.243,3.872-1.237,5.843-0.208  c1.894,0.988,3.777,2.002,5.624,3.075c2.646,1.541,3.561,5.076,2.022,7.71c-0.276,0.472-0.664,0.891-1.05,1.284  c-1.166,1.191-2.382,2.332-3.53,3.539c-1.396,1.469-3.08,2.178-5.095,2.135C39.266,48.586,38.974,48.593,38.683,48.593z" />
                </svg>
            </span> -->
            <span class="CrossClose" (click)="CloseChatBox()"> <svg xmlns="http://www.w3.org/2000/svg" width="19px"
                    height="19px" viewBox="0 0 384 512">
                    <path
                        d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z" />
                </svg> </span>
        </div>
    </div>

    <!--*********** UserName Without Login ***********-->

    <div class="userNameFormSection" *ngIf="!guestUserLogin">
        <div class="userNameForm position-relative">
            <div class="d-flex align-items-center">
                <svg (click)=" CloseChatBox();guestUserLogin=false" viewBox="0 0 24 24" width="20" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z"
                            fill="#0F1729"></path>
                    </g>
                </svg>
                <div style="padding-left: 10px;">Type your name
                </div>
            </div>
            <div class="w-100 position-relative">
                <input class=" name-input-enter w-100" style="padding-bottom: 7px;" type="text" id="userName"
                    [(ngModel)]="userName" name="userName" required #nameInput="ngModel"
                    placeholder="Enter your name" />
                <div class="errorMessageValidation position-absolute" style="top: 100%; font-size: 12px;"
                    *ngIf="nameInput.invalid && (nameInput.dirty || nameInput.touched)">
                    <div *ngIf="nameInput.errors && nameInput.errors['required']">Name is required.</div>
                </div>
            </div>
            <span class="d-flex justify-content-end position-relative" style="z-index: 10;">
                <button class="btn btn-subb" (click)="startChat()" [disabled]="nameInput.invalid">
                    <svg version="1.1" id="Layer_1" width="20px" height="20px" fill="#ffffff"
                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                        viewBox="0 0 24 24" xml:space="preserve" style="enable-background: new 0 0 24 24;">
                        <path d="M1.9,22.2c-0.5,0.2-0.9,0.1-1.3-0.1C0.2,21.8,0,21.4,0,20.9v-6.2L11,12L0,9.2V3.1c0-0.5,0.2-0.9,0.6-1.2
	C1,1.6,1.5,1.6,1.9,1.8l21.2,8.9C23.7,11,24,11.4,24,12c0,0.6-0.3,1-0.9,1.3L1.9,22.2z"></path>
                    </svg></button>
                <!-- <button class="btn btn-danger ms-2" (click)=" CloseChatBox();guestUserLogin=false">Cancel</button> -->
            </span>
            <div class="end-line position-absolute"></div>
        </div>
    </div>




    <!--*********** UserName Without Login End ***********-->

    <div class="body" [ngClass]="{'bodyheight':!isKeyboardMbl,'':isKeyboardMbl,'height-calc' : isLocked}">

        <div class="message-list" #scrollContainer>
            <!-- <div *ngIf="isUploading" class="d-flex justify-content-end">
                <div class="d-flex flex-column justify-content-center align-items-center loaderrr">
                    <div class="loader"></div>
                </div>
            </div> -->
            <div *ngIf="uploadDoc" class="d-flex justify-content-end">
                <div class="d-flex align-items-center loaderrr-documents">
                    <div class="d-flex align-items-center justify-content-start inner-doc">
                        <div>
                            <div class="position-relative">
                                <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"
                                    viewBox="0 0 22 26" width="26" preserveAspectRatio="xMidYMid meet" class=""
                                    fill="none" height="31">
                                    <title fill="none">document-HTM-icon</title>
                                    <path fill="#757778"
                                        d="M1 5.8c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311C3.28 1 4.12 1 5.8 1h5.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.441 1.285L17 4l2.125 2.125c.692.692 1.038 1.038 1.286 1.442a4 4 0 0 1 .479 1.156c.11.46.11.95.11 1.928V20.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C18.72 25 17.88 25 16.2 25H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 22.72 1 21.88 1 20.2V5.8Z">
                                    </path>
                                    <path stroke="#FFFFFF" stroke-opacity="0.15" stroke-width="0.5px"
                                        d="m21.133 8.665-.243.058.243-.058a4.25 4.25 0 0 0-.51-1.229c-.262-.429-.628-.794-1.294-1.46l-.027-.027-2.125-2.126-1.126-1.125-.027-.027c-.666-.666-1.031-1.032-1.46-1.295a4.251 4.251 0 0 0-1.229-.509C12.846.75 12.33.75 11.387.75H5.788c-.83 0-1.468 0-1.979.042-.515.042-.922.128-1.284.312a3.25 3.25 0 0 0-1.42 1.42c-.185.363-.271.77-.313 1.285C.75 4.32.75 4.96.75 5.79v14.423c0 .83 0 1.468.042 1.979.042.515.128.922.312 1.285a3.25 3.25 0 0 0 1.42 1.42c.363.184.77.27 1.285.312.51.042 1.15.042 1.98.042h10.423c.83 0 1.468 0 1.979-.042.515-.042.922-.128 1.285-.312a3.25 3.25 0 0 0 1.42-1.42c.184-.363.27-.77.312-1.285.042-.51.042-1.15.042-1.98V10.614c0-.942 0-1.459-.117-1.948Z"
                                        fill="none"></path>
                                    <g filter="url(#a)" fill="none">
                                        <path fill="#FFFFFF" fill-opacity="0.4" fill-rule="evenodd"
                                            d="m20.71 8.092-5.975-.026a1 1 0 0 1-.995-1.004l.025-5.81c.219.086.43.19.631.314.4.244.744.586 1.43 1.268L17 3.999l2.143 2.13c.701.696 1.052 1.044 1.302 1.452.101.164.19.335.266.511Z"
                                            clip-rule="evenodd" shape-rendering="crispEdges"></path>
                                    </g>
                                    <defs>
                                        <filter id="a" width="7.97" height="7.84" x="13.239" y="1.253"
                                            color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse">
                                            <feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood>
                                            <feColorMatrix in="SourceAlpha" result="hardAlpha"
                                                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"></feColorMatrix>
                                            <feOffset dy="0.5"></feOffset>
                                            <feGaussianBlur stdDeviation="0.25"></feGaussianBlur>
                                            <feComposite in2="hardAlpha" operator="out"></feComposite>
                                            <feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0">
                                            </feColorMatrix>
                                            <feBlend in2="BackgroundImageFix" result="effect1_dropShadow_491_191">
                                            </feBlend>
                                            <feBlend in="SourceGraphic" in2="effect1_dropShadow_491_191" result="shape">
                                            </feBlend>
                                        </filter>
                                    </defs>
                                    <foreignObject x="0" y="0" width="100%" height="100%" fill="none">
                                        <div class="" fill="none"></div>
                                    </foreignObject>
                                </svg>
                                <span class="htm">HTM</span>
                            </div>
                        </div>
                        <div class="d-flex flex-column w-100" style="margin: 0 10px;">
                            <span style="font-size: 14.2px;"></span>
                            <span style="font-size: 11px; color: #00000099;">extension</span>
                        </div>
                        <div>
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 50 50">
                                <circle cx="25" cy="25" r="20" fill="none" stroke="#54656F" stroke-width="5"
                                    stroke-linecap="round" stroke-dasharray="31.4 188.4" transform="rotate(0 25 25)">
                                    <animateTransform attributeName="transform" type="rotate" from="0 25 25"
                                        to="360 25 25" dur="1s" repeatCount="indefinite" />
                                </circle>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="isUploadingImg" class="d-flex justify-content-end">
                <div class="d-flex flex-column justify-content-center align-items-center loaderrr-imgg "
                    style="padding-bottom: 10px;">
                    <div class="logoImg-loader-33">
                        <div class="loader"></div>
                    </div>
                </div>
            </div>
            <div *ngIf="voiceLoading" class="d-flex justify-content-end ">
                <div class="d-flex align-items-center voice-msg-loader position-relative">
                    <div class="d-flex align-items-center" style="column-gap: 10px;">
                        <div class="position-relative">
                            <img class="logoImg-loader" alt="">
                            <span class="mike-icon-loader">
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                    viewBox="0 0 19 26" height="28" width="21" preserveAspectRatio="xMidYMid meet"
                                    version="1.1" x="0px" y="0px" enable-background="new 0 0 19 26">
                                    <title>ptt-status</title>
                                    <path fill="transparent"
                                        d="M9.217,24.401c-1.158,0-2.1-0.941-2.1-2.1v-2.366c-2.646-0.848-4.652-3.146-5.061-5.958L2.004,13.62 l-0.003-0.081c-0.021-0.559,0.182-1.088,0.571-1.492c0.39-0.404,0.939-0.637,1.507-0.637h0.3c0.254,0,0.498,0.044,0.724,0.125v-6.27 C5.103,2.913,7.016,1,9.367,1c2.352,0,4.265,1.913,4.265,4.265v6.271c0.226-0.081,0.469-0.125,0.723-0.125h0.3 c0.564,0,1.112,0.233,1.501,0.64s0.597,0.963,0.571,1.526c0,0.005,0.001,0.124-0.08,0.6c-0.47,2.703-2.459,4.917-5.029,5.748v2.378 c0,1.158-0.942,2.1-2.1,2.1H9.217V24.401z"
                                        class="ptt-status-background"></path>
                                    <path fill="currentColor"
                                        d="M9.367,15.668c1.527,0,2.765-1.238,2.765-2.765V5.265c0-1.527-1.238-2.765-2.765-2.765 S6.603,3.738,6.603,5.265v7.638C6.603,14.43,7.84,15.668,9.367,15.668z M14.655,12.91h-0.3c-0.33,0-0.614,0.269-0.631,0.598 c0,0,0,0-0.059,0.285c-0.41,1.997-2.182,3.505-4.298,3.505c-2.126,0-3.904-1.521-4.304-3.531C5.008,13.49,5.008,13.49,5.008,13.49 c-0.016-0.319-0.299-0.579-0.629-0.579h-0.3c-0.33,0-0.591,0.258-0.579,0.573c0,0,0,0,0.04,0.278 c0.378,2.599,2.464,4.643,5.076,4.978v3.562c0,0.33,0.27,0.6,0.6,0.6h0.3c0.33,0,0.6-0.27,0.6-0.6V18.73 c2.557-0.33,4.613-2.286,5.051-4.809c0.057-0.328,0.061-0.411,0.061-0.411C15.243,13.18,14.985,12.91,14.655,12.91z"
                                        class="ptt-status-icon"></path>
                                </svg>
                            </span>
                        </div>
                        <div style="padding:0px 9px 0px 6px;">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 50 50">
                                <circle cx="25" cy="25" r="20" fill="none" stroke="#54656F" stroke-width="5"
                                    stroke-linecap="round" stroke-dasharray="31.4 188.4" transform="rotate(0 25 25)">
                                    <animateTransform attributeName="transform" type="rotate" from="0 25 25"
                                        to="360 25 25" dur="1s" repeatCount="indefinite" />
                                </circle>
                            </svg>
                        </div>
                    </div>
                    <div class="linee-voice-loader"></div>
                    <div style="position: absolute; bottom: 5px; right: 8px; font-size: 11px; color: #667781;">00:00 PM
                        <span class="singleTick">
                            <svg viewBox="0 0 12 11" height="11" width="16" preserveAspectRatio="xMidYMid meet" class=""
                                fill="none">
                                <title>msg-check</title>
                                <path
                                    d="M11.1549 0.652832C11.0745 0.585124 10.9729 0.55127 10.8502 0.55127C10.7021 0.55127 10.5751 0.610514 10.4693 0.729004L4.28038 8.36523L1.87461 6.09277C1.8323 6.04622 1.78151 6.01025 1.72227 5.98486C1.66303 5.95947 1.60166 5.94678 1.53819 5.94678C1.407 5.94678 1.29275 5.99544 1.19541 6.09277L0.884379 6.40381C0.79128 6.49268 0.744731 6.60482 0.744731 6.74023C0.744731 6.87565 0.79128 6.98991 0.884379 7.08301L3.88047 10.0791C4.02859 10.2145 4.19574 10.2822 4.38194 10.2822C4.48773 10.2822 4.58929 10.259 4.68663 10.2124C4.78396 10.1659 4.86436 10.1003 4.92784 10.0156L11.5738 1.59863C11.6458 1.5013 11.6817 1.40186 11.6817 1.30029C11.6817 1.14372 11.6183 1.01888 11.4913 0.925781L11.1549 0.652832Z"
                                    fill="currentcolor"></path>
                            </svg>
                        </span>
                    </div>
                </div>
            </div>

            <ng-container *ngFor="let message of messages.slice().reverse();let i =index;">
                <ng-container *ngIf="message.sender == 'client' || message?.myMessage">

                    <div class="d-flex justify-content-end main-msg position-relative messagel" style="width: 99%;"
                        [class.new-message]="message.isNew && message.type === 'text' && !message.deleted">


                        <div class="message d-flex hide-scrollbar" [ngClass]="{'messageAnimation': showAnimation && message.myMessage, 'flex-column': (message.message.length > 30 ),
                                'for-voice-note' : message.message.includes('voice-message'),
                                'for-img' : (message.type == 'image' || message.type == 'video') && !message.deleted
                            }">


                            <!-- <div class="dropdown-toggle position-relative" data-bs-toggle="dropdown"
                            aria-expanded="false"> -->
                            <div class="position-relative">
                                <span class="messagetext" *ngIf="message.deleted" style="
                                       display: flex;
                                       color: #869680;
                                       font-style: italic;
                                       font-size: 14px;">

                                    <svg viewBox="0 0 24 24" height="20" width="20" preserveAspectRatio="xMidYMid meet"
                                        class="" fill="currentColor">
                                        <title>recalled</title>
                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                            d="M7.75897 6.43054C8.93584 5.533 10.4057 5 12 5C15.866 5 19 8.13401 19 12C19 13.5943 18.467 15.0642 17.5695 16.241L7.75897 6.43054ZM6.35707 7.85707C5.50399 9.01706 5 10.4497 5 12C5 15.866 8.13401 19 12 19C13.5503 19 14.9829 18.496 16.1429 17.6429L6.35707 7.85707ZM12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3Z"
                                            fill="currentColor"></path>
                                    </svg> You deleted this message
                                </span>

                                <span class="messageOptions down-context" (click)="ismsgDell(i,message)"
                                    *ngIf="!message.deleted" style="cursor: pointer;">
                                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        fill="#667781" version="1.1" id="Capa_1" width="12px" height="12px"
                                        viewBox="0 0 30.727 30.727" xml:space="preserve">
                                        <g>
                                            <path
                                                d="M29.994,10.183L15.363,24.812L0.733,10.184c-0.977-0.978-0.977-2.561,0-3.536c0.977-0.977,2.559-0.976,3.536,0   l11.095,11.093L26.461,6.647c0.977-0.976,2.559-0.976,3.535,0C30.971,7.624,30.971,9.206,29.994,10.183z" />
                                        </g>
                                    </svg>
                                </span>
                                <span class="messagetext ttt" *ngIf="message?.type == 'text' && !message.deleted">
                                    {{ message.message }}mm
                                </span>



                                <span
                                    *ngIf="(message.type == 'image' || message.type == 'video' || message.type == 'isfile') && !message.deleted"
                                    class="messagetext">
                                    <ng-container *ngIf="message?.type == 'image'">

                                        <a (click)="openModal(message)">
                                            <img [src]="message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"
                                                alt="" style="width: 100%;max-height: 338px;object-fit: cover;">
                                        </a>
                                    </ng-container>
                                    <ng-container *ngIf="message?.type == 'video'">

                                        <a href="{{  message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message }}"
                                            target="_blank">
                                            <video controls
                                                [src]="message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"
                                                style="max-width: 220px;">
                                            </video>
                                        </a>
                                    </ng-container>
                                    <span class="chat-message">
                                        <!-- Other message content -->

                                        <!-- Displaying the file link -->
                                        <ng-container *ngIf="message.type == 'isfile' ">
                                            <span class="fileView" *ngIf="!message.message.includes('voice-message')">
                                                <!-- *ngIf="!message.message.includes('.mp3')" -->
                                                <!-- <div class="fileViewBasic"
                                                    [ngClass]="message.type  == 'isfile' ? 'fileViewpdf' : 'fileViewOther' ">

                                                </div> -->


                                                <div class="d-flex align-items-center justify-content-start inner-doc">
                                                    <div style="width: 24px;"
                                                        [ngClass]="message.type === 'isfile' ? 'fileViewpdf' : 'fileViewOther'">
                                                        <ng-container
                                                            *ngIf="getFileExtension(message.message) === 'pdf'; else otherFile">
                                                            <div class="position-relative">
                                                                <svg xmlns:xlink="http://www.w3.org/1999/xlink"
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    viewBox="0 0 22 26" width="26"
                                                                    preserveAspectRatio="xMidYMid meet" class=""
                                                                    fill="none" height="31">
                                                                    <title fill="none">document-PDF-icon</title>
                                                                    <path fill="#D10335"
                                                                        d="M1 5.8c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311C3.28 1 4.12 1 5.8 1h5.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.441 1.285L17 4l2.125 2.125c.692.692 1.038 1.038 1.286 1.442a4 4 0 0 1 .479 1.156c.11.46.11.95.11 1.928V20.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C18.72 25 17.88 25 16.2 25H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 22.72 1 21.88 1 20.2V5.8Z">
                                                                    </path>
                                                                    <path stroke="#FFFFFF" stroke-opacity="0.15"
                                                                        stroke-width="0.5px"
                                                                        d="m21.133 8.665-.243.058.243-.058a4.25 4.25 0 0 0-.51-1.229c-.262-.429-.628-.794-1.294-1.46l-.027-.027-2.125-2.126-1.126-1.125-.027-.027c-.666-.666-1.031-1.032-1.46-1.295a4.251 4.251 0 0 0-1.229-.509C12.846.75 12.33.75 11.387.75H5.788c-.83 0-1.468 0-1.979.042-.515.042-.922.128-1.284.312a3.25 3.25 0 0 0-1.42 1.42c-.185.363-.271.77-.313 1.285C.75 4.32.75 4.96.75 5.79v14.423c0 .83 0 1.468.042 1.979.042.515.128.922.312 1.285a3.25 3.25 0 0 0 1.42 1.42c.363.184.77.27 1.285.312.51.042 1.15.042 1.98.042h10.423c.83 0 1.468 0 1.979-.042.515-.042.922-.128 1.285-.312a3.25 3.25 0 0 0 1.42-1.42c.184-.363.27-.77.312-1.285.042-.51.042-1.15.042-1.98V10.614c0-.942 0-1.459-.117-1.948Z"
                                                                        fill="none"></path>
                                                                    <g filter="url(#a)" fill="none">
                                                                        <path fill="#FFFFFF" fill-opacity="0.4"
                                                                            fill-rule="evenodd"
                                                                            d="m20.71 8.092-5.975-.026a1 1 0 0 1-.995-1.004l.025-5.81c.219.086.43.19.631.314.4.244.744.586 1.43 1.268L17 3.999l2.143 2.13c.701.696 1.052 1.044 1.302 1.452.101.164.19.335.266.511Z"
                                                                            clip-rule="evenodd"
                                                                            shape-rendering="crispEdges"></path>
                                                                    </g>
                                                                    <defs>
                                                                        <filter id="a" width="7.97" height="7.84"
                                                                            x="13.239" y="1.253"
                                                                            color-interpolation-filters="sRGB"
                                                                            filterUnits="userSpaceOnUse">
                                                                            <feFlood flood-opacity="0"
                                                                                result="BackgroundImageFix"></feFlood>
                                                                            <feColorMatrix in="SourceAlpha"
                                                                                result="hardAlpha"
                                                                                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0">
                                                                            </feColorMatrix>
                                                                            <feOffset dy="0.5"></feOffset>
                                                                            <feGaussianBlur stdDeviation="0.25">
                                                                            </feGaussianBlur>
                                                                            <feComposite in2="hardAlpha" operator="out">
                                                                            </feComposite>
                                                                            <feColorMatrix
                                                                                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0">
                                                                            </feColorMatrix>
                                                                            <feBlend in2="BackgroundImageFix"
                                                                                result="effect1_dropShadow_491_191">
                                                                            </feBlend>
                                                                            <feBlend in="SourceGraphic"
                                                                                in2="effect1_dropShadow_491_191"
                                                                                result="shape"></feBlend>
                                                                        </filter>
                                                                    </defs>
                                                                    <foreignObject x="0" y="0" width="100%"
                                                                        height="100%" fill="none">
                                                                        <div class="" fill="none"></div>
                                                                    </foreignObject>
                                                                </svg>
                                                                <span class="htm">PDF</span>
                                                            </div>
                                                        </ng-container>
                                                        <ng-template #otherFile>
                                                            <div class="position-relative">
                                                                <svg xmlns:xlink="http://www.w3.org/1999/xlink"
                                                                    xmlns="http://www.w3.org/2000/svg"
                                                                    viewBox="0 0 22 26" width="26"
                                                                    preserveAspectRatio="xMidYMid meet" class=""
                                                                    fill="none" height="31">
                                                                    <title fill="none">document-HTM-icon</title>
                                                                    <path fill="#757778"
                                                                        d="M1 5.8c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311C3.28 1 4.12 1 5.8 1h5.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.441 1.285L17 4l2.125 2.125c.692.692 1.038 1.038 1.286 1.442a4 4 0 0 1 .479 1.156c.11.46.11.95.11 1.928V20.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C18.72 25 17.88 25 16.2 25H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 22.72 1 21.88 1 20.2V5.8Z">
                                                                    </path>
                                                                    <path stroke="#FFFFFF" stroke-opacity="0.15"
                                                                        stroke-width="0.5px"
                                                                        d="m21.133 8.665-.243.058.243-.058a4.25 4.25 0 0 0-.51-1.229c-.262-.429-.628-.794-1.294-1.46l-.027-.027-2.125-2.126-1.126-1.125-.027-.027c-.666-.666-1.031-1.032-1.46-1.295a4.251 4.251 0 0 0-1.229-.509C12.846.75 12.33.75 11.387.75H5.788c-.83 0-1.468 0-1.979.042-.515.042-.922.128-1.284.312a3.25 3.25 0 0 0-1.42 1.42c-.185.363-.271.77-.313 1.285C.75 4.32.75 4.96.75 5.79v14.423c0 .83 0 1.468.042 1.979.042.515.128.922.312 1.285a3.25 3.25 0 0 0 1.42 1.42c.363.184.77.27 1.285.312.51.042 1.15.042 1.98.042h10.423c.83 0 1.468 0 1.979-.042.515-.042.922-.128 1.285-.312a3.25 3.25 0 0 0 1.42-1.42c.184-.363.27-.77.312-1.285.042-.51.042-1.15.042-1.98V10.614c0-.942 0-1.459-.117-1.948Z"
                                                                        fill="none"></path>
                                                                    <g filter="url(#a)" fill="none">
                                                                        <path fill="#FFFFFF" fill-opacity="0.4"
                                                                            fill-rule="evenodd"
                                                                            d="m20.71 8.092-5.975-.026a1 1 0 0 1-.995-1.004l.025-5.81c.219.086.43.19.631.314.4.244.744.586 1.43 1.268L17 3.999l2.143 2.13c.701.696 1.052 1.044 1.302 1.452.101.164.19.335.266.511Z"
                                                                            clip-rule="evenodd"
                                                                            shape-rendering="crispEdges"></path>
                                                                    </g>
                                                                    <defs>
                                                                        <filter id="a" width="7.97" height="7.84"
                                                                            x="13.239" y="1.253"
                                                                            color-interpolation-filters="sRGB"
                                                                            filterUnits="userSpaceOnUse">
                                                                            <feFlood flood-opacity="0"
                                                                                result="BackgroundImageFix"></feFlood>
                                                                            <feColorMatrix in="SourceAlpha"
                                                                                result="hardAlpha"
                                                                                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0">
                                                                            </feColorMatrix>
                                                                            <feOffset dy="0.5"></feOffset>
                                                                            <feGaussianBlur stdDeviation="0.25">
                                                                            </feGaussianBlur>
                                                                            <feComposite in2="hardAlpha" operator="out">
                                                                            </feComposite>
                                                                            <feColorMatrix
                                                                                values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0">
                                                                            </feColorMatrix>
                                                                            <feBlend in2="BackgroundImageFix"
                                                                                result="effect1_dropShadow_491_191">
                                                                            </feBlend>
                                                                            <feBlend in="SourceGraphic"
                                                                                in2="effect1_dropShadow_491_191"
                                                                                result="shape">
                                                                            </feBlend>
                                                                        </filter>
                                                                    </defs>
                                                                    <foreignObject x="0" y="0" width="100%"
                                                                        height="100%" fill="none">
                                                                        <div class="" fill="none"></div>
                                                                    </foreignObject>
                                                                </svg>
                                                                <span class="htm">OTH</span>
                                                            </div>
                                                        </ng-template>
                                                    </div>
                                                    <div class="d-flex flex-column w-100" style="margin: 0 10px;">
                                                        <span style="font-size: 14.2px;">{{
                                                            removeNamePdf(message?.message.replace('/uploads/', ''))
                                                            }}</span>
                                                        <span style="font-size: 11px; color: #00000099;">{{
                                                            message?.message.split('.').pop() }}</span>
                                                    </div>
                                                    <div style="cursor: pointer;">
                                                        <svg (click)="downloadFile(message)"
                                                            xmlns:xlink="http://www.w3.org/1999/xlink"
                                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34 34"
                                                            height="34" width="34" preserveAspectRatio="xMidYMid meet"
                                                            class="" version="1.1" x="0px" y="0px"
                                                            enable-background="new 0 0 34 34">
                                                            <title>audio-download</title>
                                                            <path fill="#000"
                                                                d="M17,2c8.3,0,15,6.7,15,15s-6.7,15-15,15S2,25.3,2,17S8.7,2,17,2 M17,1C8.2,1,1,8.2,1,17 s7.2,16,16,16s16-7.2,16-16S25.8,1,17,1L17,1z"
                                                                fill-opacity="0.5"></path>
                                                            <path fill="#000"
                                                                d="M22.4,17.5h-3.2v-6.8c0-0.4-0.3-0.7-0.7-0.7h-3.2c-0.4,0-0.7,0.3-0.7,0.7v6.8h-3.2 c-0.6,0-0.8,0.4-0.4,0.8l5,5.3c0.5,0.7,1,0.5,1.5,0l5-5.3C23.2,17.8,23,17.5,22.4,17.5z"
                                                                fill-opacity="0.5"></path>
                                                        </svg>

                                                    </div>
                                                </div>
                                                <!-- <span class="fileViewBasic" [ngClass]="
                                            message.url?.includes('webm') 
                                            ? 'fileViewWebm' 
                                            : message.type == 'isfile' 
                                                ? 'fileViewpdf' 
                                                : 'fileViewOther'
                                            ">
                                            </span> -->

                                                <!-- <a href="{{ message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message}}"
                                                    target="_blank" class="fileLinkText">
                                                    {{ removeNamePdf(message?.message.replace('/uploads/', '')) }}</a> -->
                                            </span>
                                            <span class="client-site" *ngIf="message.message.includes('voice-message')">
                                                <!-- <audio style="max-width: 280px; padding-top: 10px;" controls
                                                    controlsList="nodownload"
                                                    [src]=" message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"></audio> -->


                                                <lib-audio-message [message]="message">
                                                </lib-audio-message>

                                                <!-- <div *ngIf="message.message.includes('voice-message')"
                                                    class="audio-message">
                                                    <button class="play-btn" (click)="toggleAudio(message)">
                                                        <span *ngIf="!message.isPlaying">▶️</span>
                                                        <span *ngIf="message.isPlaying">⏸️</span>
                                                    </button>

                                                    <div class="audio-waveform"></div>

                                                    <span class="timestamp">{{ message.time }}</span>

                                                    <img class="avatar" [src]="message.senderImage" alt="Sender" />
                                                </div> -->


                                            </span>

                                        </ng-container>

                                    </span>
                                </span>

                                <div class="ps-2 d-flex justify-content-end align-items-center"
                                    style="max-height: 18px;" [ngClass]="{
                                    'voice-msg' : message.message.includes('voice-message')}">
                                    <span class="time me-1" *ngIf="message?.edited &&  !message.deleted">Edited</span>
                                    <span class="time">{{message?.timestamp | date : 'h:mm a'}}</span>
                                    <span class="doubleTick" *ngIf="message?.isread !== undefined">

                                        <svg viewBox="0 0 16 11" height="11" width="16"
                                            preserveAspectRatio="xMidYMid meet" class="" fill="none"
                                            [ngClass]=" message?.isread ? 'doubleTickread' :'' ">
                                            <title>msg-dblcheck</title>
                                            <path
                                                d="M11.0714 0.652832C10.991 0.585124 10.8894 0.55127 10.7667 0.55127C10.6186 0.55127 10.4916 0.610514 10.3858 0.729004L4.19688 8.36523L1.79112 6.09277C1.7488 6.04622 1.69802 6.01025 1.63877 5.98486C1.57953 5.95947 1.51817 5.94678 1.45469 5.94678C1.32351 5.94678 1.20925 5.99544 1.11192 6.09277L0.800883 6.40381C0.707784 6.49268 0.661235 6.60482 0.661235 6.74023C0.661235 6.87565 0.707784 6.98991 0.800883 7.08301L3.79698 10.0791C3.94509 10.2145 4.11224 10.2822 4.29844 10.2822C4.40424 10.2822 4.5058 10.259 4.60313 10.2124C4.70046 10.1659 4.78086 10.1003 4.84434 10.0156L11.4903 1.59863C11.5623 1.5013 11.5982 1.40186 11.5982 1.30029C11.5982 1.14372 11.5348 1.01888 11.4078 0.925781L11.0714 0.652832ZM8.6212 8.32715C8.43077 8.20866 8.2488 8.09017 8.0753 7.97168C7.99489 7.89128 7.8891 7.85107 7.75791 7.85107C7.6098 7.85107 7.4892 7.90397 7.3961 8.00977L7.10411 8.33984C7.01947 8.43717 6.97715 8.54508 6.97715 8.66357C6.97715 8.79476 7.0237 8.90902 7.1168 9.00635L8.1959 10.0791C8.33132 10.2145 8.49636 10.2822 8.69102 10.2822C8.79681 10.2822 8.89838 10.259 8.99571 10.2124C9.09304 10.1659 9.17556 10.1003 9.24327 10.0156L15.8639 1.62402C15.9358 1.53939 15.9718 1.43994 15.9718 1.32568C15.9718 1.1818 15.9125 1.05697 15.794 0.951172L15.4386 0.678223C15.3582 0.610514 15.2587 0.57666 15.1402 0.57666C14.9964 0.57666 14.8715 0.635905 14.7657 0.754395L8.6212 8.32715Z"
                                                fill="currentColor"></path>
                                        </svg>
                                    </span>
                                    <span class="singleTick"
                                        *ngIf="message?.viewurl  && message?.sender == 'client' &&  !message.deleted && message?.isread == undefined">
                                        <!-- *ngIf="!message?.delivered && !message?.read  && message?.sender == 'client'" -->
                                        <svg viewBox="0 0 12 11" height="11" width="16"
                                            preserveAspectRatio="xMidYMid meet" class="" fill="none">
                                            <title>msg-check</title>
                                            <path
                                                d="M11.1549 0.652832C11.0745 0.585124 10.9729 0.55127 10.8502 0.55127C10.7021 0.55127 10.5751 0.610514 10.4693 0.729004L4.28038 8.36523L1.87461 6.09277C1.8323 6.04622 1.78151 6.01025 1.72227 5.98486C1.66303 5.95947 1.60166 5.94678 1.53819 5.94678C1.407 5.94678 1.29275 5.99544 1.19541 6.09277L0.884379 6.40381C0.79128 6.49268 0.744731 6.60482 0.744731 6.74023C0.744731 6.87565 0.79128 6.98991 0.884379 7.08301L3.88047 10.0791C4.02859 10.2145 4.19574 10.2822 4.38194 10.2822C4.48773 10.2822 4.58929 10.259 4.68663 10.2124C4.78396 10.1659 4.86436 10.1003 4.92784 10.0156L11.5738 1.59863C11.6458 1.5013 11.6817 1.40186 11.6817 1.30029C11.6817 1.14372 11.6183 1.01888 11.4913 0.925781L11.1549 0.652832Z"
                                                fill="currentcolor"></path>
                                        </svg>
                                    </span>
                                    <span class="pendding" *ngIf="message?.myMessage">
                                        <svg viewBox="0 0 16 15" width="16" preserveAspectRatio="xMidYMid meet" class=""
                                            version="1.1" x="0px" y="0px" enable-background="new 0 0 16 15">
                                            <title>msg-time</title>
                                            <path fill="currentColor"
                                                d="M9.75,7.713H8.244V5.359c0-0.276-0.224-0.5-0.5-0.5H7.65c-0.276,0-0.5,0.224-0.5,0.5v2.947 c0,0.276,0.224,0.5,0.5,0.5h0.094c0.001,0,0.002-0.001,0.003-0.001S7.749,8.807,7.75,8.807h2c0.276,0,0.5-0.224,0.5-0.5V8.213 C10.25,7.937,10.026,7.713,9.75,7.713z M9.75,2.45h-3.5c-1.82,0-3.3,1.48-3.3,3.3v3.5c0,1.82,1.48,3.3,3.3,3.3h3.5 c1.82,0,3.3-1.48,3.3-3.3v-3.5C13.05,3.93,11.57,2.45,9.75,2.45z M11.75,9.25c0,1.105-0.895,2-2,2h-3.5c-1.104,0-2-0.895-2-2v-3.5 c0-1.104,0.896-2,2-2h3.5c1.105,0,2,0.896,2,2V9.25z">
                                            </path>
                                        </svg>
                                    </span>
                                </div>


                            </div>
                            <div [ngClass]="{
                                'active-Dropdown':msgAction === i
                            }" class="top-dropdown message-actions" appClickOutside
                                (appClickOutside)="msgAction = null">
                                <ul class="ul-dropdown-menu" style="cursor: pointer;">
                                    <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                            (click)="deleteMessage(message,i)">Delete</a></li>
                                    <!-- (click)="updateMessage(msg,i)" -->
                                    <li *ngIf="message?.type == 'text' && shouldShowEditButton">
                                        <a (click)="updateMessage(message,i)" class="dropdown-item"
                                            data-bs-toggle="modal" data-bs-target="#exampleModal">
                                            Edit
                                        </a>
                                    </li>
                                </ul>
                            </div>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" data-bs-toggle="modal" data-bs-target="#deleteModal"
                                        (click)="deleteMessage(message,i)">Delete</a></li>
                                <!-- (click)="updateMessage(msg,i)" -->
                                <li>
                                    <a (click)="updateMessage(message,i)" class="dropdown-item" data-bs-toggle="modal"
                                        data-bs-target="#exampleModal">
                                        Edit
                                    </a>
                                </li>
                            </ul>

                        </div>

                    </div>

                </ng-container>

                <ng-container *ngIf="message.sender == 'agent' ">

                    <div class="w-100 d-flex justify-content-start messagel" [class.new-message]="message.isNew">
                        <div class="message  receiverMessage position-relative hide-scrollbar"
                            [ngClass]="{'': showAnimation, 'flex-column': (message.message.length > 30  ),'for-voice-note' : message.message.includes('voice-message')}">
                            <span class="messagetext" *ngIf="message.deleted" style="
                                       display: flex;
                                       color: #869680;
                                       font-style: italic;
                                       font-size: 14px;">

                                <svg viewBox="0 0 24 24" height="20" width="20" preserveAspectRatio="xMidYMid meet"
                                    class="" fill="currentColor">
                                    <title>recalled</title>
                                    <path fill-rule="evenodd" clip-rule="evenodd"
                                        d="M7.75897 6.43054C8.93584 5.533 10.4057 5 12 5C15.866 5 19 8.13401 19 12C19 13.5943 18.467 15.0642 17.5695 16.241L7.75897 6.43054ZM6.35707 7.85707C5.50399 9.01706 5 10.4497 5 12C5 15.866 8.13401 19 12 19C13.5503 19 14.9829 18.496 16.1429 17.6429L6.35707 7.85707ZM12 3C7.02944 3 3 7.02944 3 12C3 16.9706 7.02944 21 12 21C16.9706 21 21 16.9706 21 12C21 7.02944 16.9706 3 12 3Z"
                                        fill="currentColor"></path>
                                </svg> This message was deleted
                            </span>
                            <span class="messagetext" *ngIf="message.type == 'text' && !message.deleted">
                                {{ message.message }}
                            </span>


                            <span
                                *ngIf="(message.type == 'image' || message.type == 'video'|| message.type == 'isfile') && !message.deleted"
                                class="messagetext">
                                <ng-container *ngIf="message?.type == 'image'">

                                    <a href="{{  message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message}}"
                                        target="_blank">
                                        <img [src]="message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"
                                            alt="" style="width: 100%;">
                                    </a>
                                </ng-container>
                                <ng-container *ngIf="message?.type == 'video'">

                                    <a href="{{ message?.viewurl + message.message}}" target="_blank">
                                        <video controls
                                            [src]="message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"
                                            style="max-width: 220px;">
                                        </video>
                                    </a>
                                </ng-container>
                                <span class="chat-message">
                                    <!-- Other message content -->

                                    <!-- Displaying the file link -->
                                    <ng-container *ngIf="message.type == 'isfile' ">
                                        <span class="fileView" *ngIf="!message.message.includes('voice-message')">
                                            <span class="fileViewBasic"
                                                [ngClass]="message.type  == 'isfile' ? 'fileViewpdf' : 'fileViewOther' ">
                                                <ng-container
                                                    *ngIf="getFileExtension(message.message) === 'pdf'; else otherFile">
                                                    <div class="position-relative">
                                                        <svg xmlns:xlink="http://www.w3.org/1999/xlink"
                                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 26"
                                                            width="26" preserveAspectRatio="xMidYMid meet" class=""
                                                            fill="none" height="31">
                                                            <title fill="none">document-PDF-icon</title>
                                                            <path fill="#D10335"
                                                                d="M1 5.8c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311C3.28 1 4.12 1 5.8 1h5.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.441 1.285L17 4l2.125 2.125c.692.692 1.038 1.038 1.286 1.442a4 4 0 0 1 .479 1.156c.11.46.11.95.11 1.928V20.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C18.72 25 17.88 25 16.2 25H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 22.72 1 21.88 1 20.2V5.8Z">
                                                            </path>
                                                            <path stroke="#FFFFFF" stroke-opacity="0.15"
                                                                stroke-width="0.5px"
                                                                d="m21.133 8.665-.243.058.243-.058a4.25 4.25 0 0 0-.51-1.229c-.262-.429-.628-.794-1.294-1.46l-.027-.027-2.125-2.126-1.126-1.125-.027-.027c-.666-.666-1.031-1.032-1.46-1.295a4.251 4.251 0 0 0-1.229-.509C12.846.75 12.33.75 11.387.75H5.788c-.83 0-1.468 0-1.979.042-.515.042-.922.128-1.284.312a3.25 3.25 0 0 0-1.42 1.42c-.185.363-.271.77-.313 1.285C.75 4.32.75 4.96.75 5.79v14.423c0 .83 0 1.468.042 1.979.042.515.128.922.312 1.285a3.25 3.25 0 0 0 1.42 1.42c.363.184.77.27 1.285.312.51.042 1.15.042 1.98.042h10.423c.83 0 1.468 0 1.979-.042.515-.042.922-.128 1.285-.312a3.25 3.25 0 0 0 1.42-1.42c.184-.363.27-.77.312-1.285.042-.51.042-1.15.042-1.98V10.614c0-.942 0-1.459-.117-1.948Z"
                                                                fill="none"></path>
                                                            <g filter="url(#a)" fill="none">
                                                                <path fill="#FFFFFF" fill-opacity="0.4"
                                                                    fill-rule="evenodd"
                                                                    d="m20.71 8.092-5.975-.026a1 1 0 0 1-.995-1.004l.025-5.81c.219.086.43.19.631.314.4.244.744.586 1.43 1.268L17 3.999l2.143 2.13c.701.696 1.052 1.044 1.302 1.452.101.164.19.335.266.511Z"
                                                                    clip-rule="evenodd" shape-rendering="crispEdges">
                                                                </path>
                                                            </g>
                                                            <defs>
                                                                <filter id="a" width="7.97" height="7.84" x="13.239"
                                                                    y="1.253" color-interpolation-filters="sRGB"
                                                                    filterUnits="userSpaceOnUse">
                                                                    <feFlood flood-opacity="0"
                                                                        result="BackgroundImageFix"></feFlood>
                                                                    <feColorMatrix in="SourceAlpha" result="hardAlpha"
                                                                        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0">
                                                                    </feColorMatrix>
                                                                    <feOffset dy="0.5"></feOffset>
                                                                    <feGaussianBlur stdDeviation="0.25">
                                                                    </feGaussianBlur>
                                                                    <feComposite in2="hardAlpha" operator="out">
                                                                    </feComposite>
                                                                    <feColorMatrix
                                                                        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0">
                                                                    </feColorMatrix>
                                                                    <feBlend in2="BackgroundImageFix"
                                                                        result="effect1_dropShadow_491_191">
                                                                    </feBlend>
                                                                    <feBlend in="SourceGraphic"
                                                                        in2="effect1_dropShadow_491_191" result="shape">
                                                                    </feBlend>
                                                                </filter>
                                                            </defs>
                                                            <foreignObject x="0" y="0" width="100%" height="100%"
                                                                fill="none">
                                                                <div class="" fill="none"></div>
                                                            </foreignObject>
                                                        </svg>
                                                        <span class="htm">PDF</span>
                                                    </div>
                                                </ng-container>
                                                <ng-template #otherFile>
                                                    <div class="position-relative">
                                                        <svg xmlns:xlink="http://www.w3.org/1999/xlink"
                                                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 22 26"
                                                            width="26" preserveAspectRatio="xMidYMid meet" class=""
                                                            fill="none" height="31">
                                                            <title fill="none">document-HTM-icon</title>
                                                            <path fill="#757778"
                                                                d="M1 5.8c0-1.68 0-2.52.327-3.162a3 3 0 0 1 1.311-1.311C3.28 1 4.12 1 5.8 1h5.549c.978 0 1.468 0 1.928.11.408.099.798.26 1.156.48.404.247.75.593 1.441 1.285L17 4l2.125 2.125c.692.692 1.038 1.038 1.286 1.442a4 4 0 0 1 .479 1.156c.11.46.11.95.11 1.928V20.2c0 1.68 0 2.52-.327 3.162a3 3 0 0 1-1.311 1.311C18.72 25 17.88 25 16.2 25H5.8c-1.68 0-2.52 0-3.162-.327a3 3 0 0 1-1.311-1.311C1 22.72 1 21.88 1 20.2V5.8Z">
                                                            </path>
                                                            <path stroke="#FFFFFF" stroke-opacity="0.15"
                                                                stroke-width="0.5px"
                                                                d="m21.133 8.665-.243.058.243-.058a4.25 4.25 0 0 0-.51-1.229c-.262-.429-.628-.794-1.294-1.46l-.027-.027-2.125-2.126-1.126-1.125-.027-.027c-.666-.666-1.031-1.032-1.46-1.295a4.251 4.251 0 0 0-1.229-.509C12.846.75 12.33.75 11.387.75H5.788c-.83 0-1.468 0-1.979.042-.515.042-.922.128-1.284.312a3.25 3.25 0 0 0-1.42 1.42c-.185.363-.271.77-.313 1.285C.75 4.32.75 4.96.75 5.79v14.423c0 .83 0 1.468.042 1.979.042.515.128.922.312 1.285a3.25 3.25 0 0 0 1.42 1.42c.363.184.77.27 1.285.312.51.042 1.15.042 1.98.042h10.423c.83 0 1.468 0 1.979-.042.515-.042.922-.128 1.285-.312a3.25 3.25 0 0 0 1.42-1.42c.184-.363.27-.77.312-1.285.042-.51.042-1.15.042-1.98V10.614c0-.942 0-1.459-.117-1.948Z"
                                                                fill="none"></path>
                                                            <g filter="url(#a)" fill="none">
                                                                <path fill="#FFFFFF" fill-opacity="0.4"
                                                                    fill-rule="evenodd"
                                                                    d="m20.71 8.092-5.975-.026a1 1 0 0 1-.995-1.004l.025-5.81c.219.086.43.19.631.314.4.244.744.586 1.43 1.268L17 3.999l2.143 2.13c.701.696 1.052 1.044 1.302 1.452.101.164.19.335.266.511Z"
                                                                    clip-rule="evenodd" shape-rendering="crispEdges">
                                                                </path>
                                                            </g>
                                                            <defs>
                                                                <filter id="a" width="7.97" height="7.84" x="13.239"
                                                                    y="1.253" color-interpolation-filters="sRGB"
                                                                    filterUnits="userSpaceOnUse">
                                                                    <feFlood flood-opacity="0"
                                                                        result="BackgroundImageFix"></feFlood>
                                                                    <feColorMatrix in="SourceAlpha" result="hardAlpha"
                                                                        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0">
                                                                    </feColorMatrix>
                                                                    <feOffset dy="0.5"></feOffset>
                                                                    <feGaussianBlur stdDeviation="0.25">
                                                                    </feGaussianBlur>
                                                                    <feComposite in2="hardAlpha" operator="out">
                                                                    </feComposite>
                                                                    <feColorMatrix
                                                                        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0">
                                                                    </feColorMatrix>
                                                                    <feBlend in2="BackgroundImageFix"
                                                                        result="effect1_dropShadow_491_191">
                                                                    </feBlend>
                                                                    <feBlend in="SourceGraphic"
                                                                        in2="effect1_dropShadow_491_191" result="shape">
                                                                    </feBlend>
                                                                </filter>
                                                            </defs>
                                                            <foreignObject x="0" y="0" width="100%" height="100%"
                                                                fill="none">
                                                                <div class="" fill="none"></div>
                                                            </foreignObject>
                                                        </svg>
                                                        <span class="htm">OTH</span>
                                                    </div>
                                                </ng-template>
                                            </span>
                                            <a href="{{ message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message}}"
                                                target="_blank" class="fileLinkText">
                                                {{ removeNamePdf(message?.message.replace('/uploads/', '')) }}</a>
                                        </span>

                                        <span class="agent-site" *ngIf="message.message.includes('voice-message')">
                                            <!-- <audio style="max-width: 280px; padding-top: 10px;" controls
                                                controlsList="nodownload"
                                                [src]=" message?.viewurl.includes('localhost')  ? baseURL + message?.message : message?.viewurl + message.message"></audio> -->
                                            <lib-audio-message [message]="message">
                                            </lib-audio-message>

                                        </span>

                                    </ng-container>

                                </span>
                            </span>
                            <div class="d-flex justify-content-end align-items-center" [ngClass]="{
                                'voice-msg-agent' : message.message.includes('voice-message')
                            }">
                                <span class="time me-1" *ngIf="message?.edited &&  !message.deleted">Edited</span>
                                <span class="time">{{message?.timestamp | date : 'h:mm a'}}</span>

                            </div>
                        </div>
                    </div>

                </ng-container>
            </ng-container>
        </div>

    </div>



    <!---***********  Bottom Bar for Chat -*********** -->
    <div class="media">
        <div class="collapse collapseBottom" id="collapseExample" #collapseElement>
            <div class="card flex-row justify-content-between card-body p-2" style="background-color: #F7F8FA;">
                <div class="d-flex flex-column align-items-center p-1 attachments" (click)="openFileInput('document')"
                    style="cursor: pointer;">
                    <div class="popup-slide">
                        <input type="file" #fileInput id="fileInput" style="display: none" accept=".zip, .pdf, application/pdf, application/zip, application/vnd.ms-excel,
                     application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                            (change)="onFileSelected($event)">

                        <svg height="20" viewBox="0 0 16 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M2 0C0.9 0 0.01 0.9 0.01 2L0 18C0 19.1 0.89 20 1.99 20H14C15.1 20 16 19.1 16 18V6.83C16 6.3 15.79 5.79 15.41 5.42L10.58 0.59C10.21 0.21 9.7 0 9.17 0H2ZM9 6V1.5L14.5 7H10C9.45 7 9 6.55 9 6ZM4 10C3.44772 10 3 10.4477 3 11C3 11.5523 3.44772 12 4 12H12C12.5523 12 13 11.5523 13 11C13 10.4477 12.5523 10 12 10H4ZM10 15C10 14.4477 9.55228 14 9 14H4C3.44772 14 3 14.4477 3 15C3 15.5523 3.44772 16 4 16H9C9.55228 16 10 15.5523 10 15Z"
                                fill="#7f66ff"></path>
                        </svg>
                    </div>

                    <span class="ps-1" style="font-size: 14px;">Document</span>
                </div>
                <div class="d-flex flex-column align-items-center p-1 attachments" (click)="openFileInput('media')"
                    style="cursor: pointer; width: 78.68px;">
                    <div class="popup-slide">
                        <input type="file" #mediaInput id="mediaInput" style="display: none" accept="image/*,video/*"
                            (change)="onFileSelected($event)">
                        <!-- <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="none">
                    <path
                        d="M8 11C9.10457 11 10 10.1046 10 9C10 7.89543 9.10457 7 8 7C6.89543 7 6 7.89543 6 9C6 10.1046 6.89543 11 8 11Z"
                        stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path d="M6.56055 21C12.1305 8.89998 16.7605 6.77998 22.0005 14.63" stroke="#000000"
                        stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    <path
                        d="M18 3H6C3.79086 3 2 4.79086 2 7V17C2 19.2091 3.79086 21 6 21H18C20.2091 21 22 19.2091 22 17V7C22 4.79086 20.2091 3 18 3Z"
                        stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                </svg> -->
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M20 14V2C20 0.9 19.1 0 18 0H6C4.9 0 4 0.9 4 2V14C4 15.1 4.9 16 6 16H18C19.1 16 20 15.1 20 14ZM9.4 10.53L11.03 12.71L13.61 9.49C13.81 9.24 14.19 9.24 14.39 9.49L17.35 13.19C17.61 13.52 17.38 14 16.96 14H7C6.59 14 6.35 13.53 6.6 13.2L8.6 10.53C8.8 10.27 9.2 10.27 9.4 10.53ZM0 18V5C0 4.45 0.45 4 1 4C1.55 4 2 4.45 2 5V17C2 17.55 2.45 18 3 18H15C15.55 18 16 18.45 16 19C16 19.55 15.55 20 15 20H2C0.9 20 0 19.1 0 18Z"
                                fill="#007bfc"></path>
                        </svg>
                    </div>

                    <span class="ps-1" style="font-size: 14px;">Gallery</span>
                </div>

            </div>
        </div>
    </div>
    <div class="emoji">
        <div [ngClass]="{
            'emoji-show' : isEmojiPickerOpen
        }" class="collapseBottomEmoji bg-white rounded shadow mt-1" style="z-index: 1002;" #emojiPanel>
            <div class="p-2 d-flex justify-content-center align-content-center">
                <div class="d-flex flex-wrap" style="row-gap: 0px; column-gap: 10px;">
                    <span class="emoji" *ngFor="let emoji of emojis" (click)="addEmojiToMessage(emoji)">
                        {{ emoji }}
                    </span>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="isEmojiPickerOpen" style="position: fixed; inset: 0; " (click)="isEmojiPickerOpen = false">

    </div>


    <!-- <div class="collapse collapseBottom show" style="bottom: 67px; max-width: 169px;" id="emojiCollapse"
        #collapseElement>
        
    </div> -->

    <!-- ========================================= mbl recording ========================================= -->

    <div *ngIf="isMobile && !isSendButtonVisible" class="voice-recorder-container" [ngClass]="{
        'recording-start' : isRecording
    }">
        <div class="recorder-button-container">
            <!-- Lock Indicator -->
            <!-- *ngIf="showLockHint && !isLocked && !showDeleteIndicator" -->
            <div *ngIf="showLockHint && !isLocked" class="lock-indicator" [class.locked]="isLocked" [ngClass]="{
                    'd-flex' : !showDeleteIndicator
                }">
                <svg class="vert-move" viewBox="0 0 24 24">
                    <path *ngIf="!isLocked"
                        d="M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" />
                    <path *ngIf="isLocked"
                        d="M12,17A2,2 0 0,0 14,15A2,2 0 0,0 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10A2,2 0 0,1 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z" />
                </svg>

                <svg class="svg-arrow vert-move-arrow" viewBox="0 0 24 24" width="10px" fill="none"
                    xmlns="http://www.w3.org/2000/svg">
                    <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                    <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M12 7C12.2652 7 12.5196 7.10536 12.7071 7.29289L19.7071 14.2929C20.0976 14.6834 20.0976 15.3166 19.7071 15.7071C19.3166 16.0976 18.6834 16.0976 18.2929 15.7071L12 9.41421L5.70711 15.7071C5.31658 16.0976 4.68342 16.0976 4.29289 15.7071C3.90237 15.3166 3.90237 14.6834 4.29289 14.2929L11.2929 7.29289C11.4804 7.10536 11.7348 7 12 7Z"
                            fill="#8b9698"></path>
                    </g>
                </svg>
            </div>

            <!-- Locked State UI -->
            <div class="recording-display" *ngIf="isLocked">
                <div class="timer-waveform-container">
                    <div *ngIf="!isPaused" class="recording-timer">
                        {{ recordingTime | date:'mm:ss' }}
                    </div>

                    <div class="sound-wave">
                        <div *ngIf="!isPaused" style="height: 40px; object-fit: cover;width: 85%;">
                            <div class="waveform">
                                <!-- 80 spans -->
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>

                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>

                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>

                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </div>


                        </div>

                        <div *ngIf="pausedPreviewUrl && isPaused" class="paused-preview">
                            <div class="d-flex align-items-center pause-recording-preview">
                                <button (click)="togglePausedAudio()" class="play-btn" style="margin: 0;">
                                    <svg *ngIf="!isPausedPlaying" xmlns="http://www.w3.org/2000/svg" width="24"
                                        height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 2v20l18-10L3 2z" />
                                    </svg>
                                    <svg *ngIf="isPausedPlaying" xmlns="http://www.w3.org/2000/svg" width="24"
                                        height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M4 2h6v20H4V2zm10 0h6v20h-6V2z" />
                                    </svg>
                                </button>

                                <canvas #pausedCanvas width="144" height="32"></canvas>

                                <div *ngIf="isPaused" class="recording-timer" style="padding-left: 8px;">
                                    {{ formatTime(pausedCurrentTime) }}
                                </div>

                                <audio #pausedAudio [src]="pausedPreviewUrl" (timeupdate)="onPausedTimeUpdate()"
                                    (loadedmetadata)="onPausedLoadedMetadata()" (ended)="onPausedEnded()"
                                    preload="metadata">
                                </audio>
                            </div>


                        </div>


                    </div>
                </div>

                <div class="locked-controls">
                    <button class="control-button delete-button" (click)="cancelRecording()">
                        <svg viewBox="0 0 24 24">
                            <path
                                d="M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z" />
                        </svg>
                    </button>

                    <button class="control-button pause-button" (click)="togglePause()">
                        <svg *ngIf="!isPaused" fill="#ff0000" viewBox="0 0 24 24">
                            <path d="M14,19H18V5H14M6,19H10V5H6V19Z" />
                        </svg>
                        <svg class="mike-svg" *ngIf="isPaused" width="30px" height="30px" fill="#ff0000"
                            viewBox="0 0 24 24">
                            <path
                                d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z" />
                        </svg>
                    </button>

                    <button class="control-button send-button" (click)="stopRecordingAndSend()">
                        <svg viewBox="0 0 24 24">
                            <path d="M2,21L23,12L2,3V10L17,12L2,14V21Z" />
                        </svg>
                    </button>
                </div>
            </div>
            <!--  -->
            <div *ngIf="showDeleteAnimation" style="position: fixed; left: 5px; bottom: 20px; z-index: 91;">
                <!-- <img src="./../../../assets/chatbox/mike-bin-anim.gif" alt="" style="width: 40px;"> -->
                <div class="gif-bg"></div>
            </div>
            <div *ngIf="showDeleteAnimation" style="    position: fixed;
                background-color: white;
                height: 66px;
                width: 100%;
                z-index: 90;
                left: 0;
                bottom: 0;">
            </div>
            <!-- Normal Recording UI -->
            <div class="recording-area" *ngIf="!isLocked">
                <div *ngIf="!isRecording"></div>
                <!--  -->
                <div *ngIf="isRecording" class="recording-ui">
                    <!-- <svg class="trash-blink" fill="#FF0100" viewBox="0 0 24 24">
                        <path
                            d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z" />
                    </svg> -->
                    <!-- <img class="trash-blink bg-trash" alt=""> -->
                    <div class="trash-blink bg-trash" style=""></div>

                    <div class="recording-timer">
                        {{ recordingTime | date:'mm:ss' }}
                    </div>
                    <!-- *ngIf="showDeleteIndicator" -->
                    <div class="delete-indicator shine">
                        <svg class="svg-arrow-slide" viewBox="0 0 24 24" width="10px" fill="none"
                            xmlns="http://www.w3.org/2000/svg">
                            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                            <g id="SVGRepo_iconCarrier">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M12 7C12.2652 7 12.5196 7.10536 12.7071 7.29289L19.7071 14.2929C20.0976 14.6834 20.0976 15.3166 19.7071 15.7071C19.3166 16.0976 18.6834 16.0976 18.2929 15.7071L12 9.41421L5.70711 15.7071C5.31658 16.0976 4.68342 16.0976 4.29289 15.7071C3.90237 15.3166 3.90237 14.6834 4.29289 14.2929L11.2929 7.29289C11.4804 7.10536 11.7348 7 12 7Z"
                                    fill="#8b9698"></path>
                            </g>
                        </svg>
                        <span style="color: #8b9698; padding-left: 5px;">Slide left to cancel</span>
                    </div>
                </div>
                <div class="short-record-msg" [ngClass]="{
                    'alert-record-ng' : showShortMsg
                }">
                    Hold to record, relest to send
                    <div class="arrow-hold"></div>
                </div>
                <button #recordButton class="record-button" (mousedown)="startRecordingMobile($event)"
                    (touchstart)="startRecordingMobile($event)" (mouseup)="cancelRecordingIfNotHeld()"
                    (touchend)="cancelRecordingIfNotHeld()" [class.recording]="isRecording">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z" />
                    </svg>
                </button>
            </div>
        </div>
    </div>


    <!-- ========================================= mbl recording ========================================= -->


    <div class="bottomChat">

        <div *ngIf="!audioRecording && !isRecording" class="chatInputDiv chat-ii">
            <div [ngClass]="{
                'plusButton-1' : isSendButtonVisible
            }" (click)="isEmojiPickerOpen = false" class="plusButton" data-bs-toggle="collapse"
                data-bs-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample"
                style="cursor: pointer;">
                <svg style="rotate: 315deg;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor" stroke-width="2" width="24" height="24">
                    <path stroke-linecap="round" stroke-linejoin="round"
                        d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828L18 10.828a4 4 0 10-5.656-5.656L6.343 11.172a6 6 0 108.485 8.485L20 14" />
                </svg>

            </div>
            <div class="camera-file d-flex align-items-center p-1 attachments" (click)="openFileInput('media')"
                [ngClass]="{
                'camera-file-1' : isSendButtonVisible
            }" style="cursor: pointer;" (click)="isEmojiPickerOpen = false">
                <input type="file" #fileInput style="display: none" accept=".zip, .pdf, application/pdf, application/zip, application/vnd.ms-excel,
                         application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                    (change)="onFileSelected($event)">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"
                    height="24" width="24" preserveAspectRatio="xMidYMid meet" class="x1cbnkk4" fill="none">
                    <title>camera-filled-refreshed</title>
                    <path
                        d="M12 17.5C13.25 17.5 14.3125 17.0625 15.1875 16.1875C16.0625 15.3125 16.5 14.25 16.5 13C16.5 11.75 16.0625 10.6875 15.1875 9.8125C14.3125 8.9375 13.25 8.5 12 8.5C10.75 8.5 9.6875 8.9375 8.8125 9.8125C7.9375 10.6875 7.5 11.75 7.5 13C7.5 14.25 7.9375 15.3125 8.8125 16.1875C9.6875 17.0625 10.75 17.5 12 17.5ZM12 15.5C11.3 15.5 10.7083 15.2583 10.225 14.775C9.74167 14.2917 9.5 13.7 9.5 13C9.5 12.3 9.74167 11.7083 10.225 11.225C10.7083 10.7417 11.3 10.5 12 10.5C12.7 10.5 13.2917 10.7417 13.775 11.225C14.2583 11.7083 14.5 12.3 14.5 13C14.5 13.7 14.2583 14.2917 13.775 14.775C13.2917 15.2583 12.7 15.5 12 15.5ZM4 21C3.45 21 2.97917 20.8042 2.5875 20.4125C2.19583 20.0208 2 19.55 2 19V7C2 6.45 2.19583 5.97917 2.5875 5.5875C2.97917 5.19583 3.45 5 4 5H7.15L8.4 3.65C8.58333 3.45 8.80417 3.29167 9.0625 3.175C9.32083 3.05833 9.59167 3 9.875 3H14.125C14.4083 3 14.6792 3.05833 14.9375 3.175C15.1958 3.29167 15.4167 3.45 15.6 3.65L16.85 5H20C20.55 5 21.0208 5.19583 21.4125 5.5875C21.8042 5.97917 22 6.45 22 7V19C22 19.55 21.8042 20.0208 21.4125 20.4125C21.0208 20.8042 20.55 21 20 21H4Z"
                        fill="currentColor"></path>
                </svg>
            </div>
            <div class="stickerr" (click)="toggleEmojiPicker($event)" style="cursor: pointer;">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"
                    height="24" width="24" preserveAspectRatio="xMidYMid meet" class="" fill="none">
                    <title>expressions</title>
                    <path
                        d="M8.49893 10.2521C9.32736 10.2521 9.99893 9.5805 9.99893 8.75208C9.99893 7.92365 9.32736 7.25208 8.49893 7.25208C7.6705 7.25208 6.99893 7.92365 6.99893 8.75208C6.99893 9.5805 7.6705 10.2521 8.49893 10.2521Z"
                        fill="currentColor"></path>
                    <path
                        d="M17.0011 8.75208C17.0011 9.5805 16.3295 10.2521 15.5011 10.2521C14.6726 10.2521 14.0011 9.5805 14.0011 8.75208C14.0011 7.92365 14.6726 7.25208 15.5011 7.25208C16.3295 7.25208 17.0011 7.92365 17.0011 8.75208Z"
                        fill="currentColor"></path>
                    <path fill-rule="evenodd" clip-rule="evenodd"
                        d="M16.8221 19.9799C15.5379 21.2537 13.8087 21.9781 12 22H9.27273C5.25611 22 2 18.7439 2 14.7273V9.27273C2 5.25611 5.25611 2 9.27273 2H14.7273C18.7439 2 22 5.25611 22 9.27273V11.8141C22 13.7532 21.2256 15.612 19.8489 16.9776L16.8221 19.9799ZM14.7273 4H9.27273C6.36068 4 4 6.36068 4 9.27273V14.7273C4 17.6393 6.36068 20 9.27273 20H11.3331C11.722 19.8971 12.0081 19.5417 12.0058 19.1204L11.9935 16.8564C11.9933 16.8201 11.9935 16.784 11.9941 16.7479C11.0454 16.7473 10.159 16.514 9.33502 16.0479C8.51002 15.5812 7.84752 14.9479 7.34752 14.1479C7.24752 13.9479 7.25585 13.7479 7.37252 13.5479C7.48919 13.3479 7.66419 13.2479 7.89752 13.2479L13.5939 13.2479C14.4494 12.481 15.5811 12.016 16.8216 12.0208L19.0806 12.0296C19.5817 12.0315 19.9889 11.6259 19.9889 11.1248V9.07648H19.9964C19.8932 6.25535 17.5736 4 14.7273 4ZM14.0057 19.1095C14.0066 19.2605 13.9959 19.4089 13.9744 19.5537C14.5044 19.3124 14.9926 18.9776 15.4136 18.5599L18.4405 15.5576C18.8989 15.1029 19.2653 14.5726 19.5274 13.996C19.3793 14.0187 19.2275 14.0301 19.0729 14.0295L16.8138 14.0208C15.252 14.0147 13.985 15.2837 13.9935 16.8455L14.0057 19.1095Z"
                        fill="currentColor"></path>
                </svg>
            </div>


            <!-- <input class="chatInput" type="text" id="chatMessage" name="chatMessage" [(ngModel)]="messageText"
                [ngClass]="{ 'chatInputDiv-1': !isSendButtonVisible }" autocomplete="off" height="40px"
                (ngModelChange)="onInputChange()" (keyup.enter)="sendMessage()" (focus)="onfocusText();"
                (focusout)="onBlurText($event)" (click)="isEmojiPickerOpen = false"> -->
            <textarea class="chatInput" type="text" id="chatMessage" name="chatMessage" [(ngModel)]="messageText"
                [ngClass]="{ 'chatInputDiv-1': !isSendButtonVisible }" autocomplete="off" height="40px"
                (ngModelChange)="onInputChange()" (keyup.enter)="sendMessage()" (focus)="onfocusText();"
                (focusout)="onBlurText($event)" (click)="isEmojiPickerOpen = false"
                [attr.autocorrect]="isIOSChrome ? 'off' : null" [attr.autocapitalize]="isIOSChrome ? 'off' : null"
                [attr.spellcheck]="isIOSChrome ? 'false' : null"></textarea>
        </div>
        <!--============== recording ======================-->
        <div *ngIf="isRecording" class=" after-record justify-content-between">

            <div class="d-flex align-items-center">
                <div class="del-recording" (click)="deleteRecording()">
                    <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet" class="x1n2onr6"
                        fill="black">
                        <title fill="none">delete-refreshed</title>
                        <path
                            d="M7 21C6.45 21 5.97917 20.8042 5.5875 20.4125C5.19583 20.0208 5 19.55 5 19V6C4.44772 6 4 5.55228 4 5C4 4.44772 4.44772 4 5 4H9V3.5C9 3.22386 9.22386 3 9.5 3H14.5C14.7761 3 15 3.22386 15 3.5V4H19C19.5523 4 20 4.44772 20 5C20 5.55228 19.5523 6 19 6V19C19 19.55 18.8042 20.0208 18.4125 20.4125C18.0208 20.8042 17.55 21 17 21H7ZM17 6H7V19H17V6ZM9 16.5C9 16.7761 9.22386 17 9.5 17H10.5C10.7761 17 11 16.7761 11 16.5V8.5C11 8.22386 10.7761 8 10.5 8H9.5C9.22386 8 9 8.22386 9 8.5V16.5ZM13 16.5C13 16.7761 13.2239 17 13.5 17H14.5C14.7761 17 15 16.7761 15 16.5V8.5C15 8.22386 14.7761 8 14.5 8H13.5C13.2239 8 13 8.22386 13 8.5V16.5Z"
                            fill="#000"></path>
                    </svg>
                </div>
                <span class="recording-indicator d-flex align-items-center">
                    <div class="sendButton mik fade-in">
                        <svg style="transform: unset;" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 19 26" height="28" width="21"
                            preserveAspectRatio="xMidYMid meet" class="" version="1.1" x="0px" y="0px"
                            enable-background="new 0 0 19 26">
                            <title>ptt-status</title>
                            <path fill="transparent" class="ptt-status-background"
                                d="M9.217,24.401c-1.158,0-2.1-0.941-2.1-2.1v-2.366c-2.646-0.848-4.652-3.146-5.061-5.958L2.004,13.62 l-0.003-0.081c-0.021-0.559,0.182-1.088,0.571-1.492c0.39-0.404,0.939-0.637,1.507-0.637h0.3c0.254,0,0.498,0.044,0.724,0.125v-6.27 C5.103,2.913,7.016,1,9.367,1c2.352,0,4.265,1.913,4.265,4.265v6.271c0.226-0.081,0.469-0.125,0.723-0.125h0.3 c0.564,0,1.112,0.233,1.501,0.64s0.597,0.963,0.571,1.526c0,0.005,0.001,0.124-0.08,0.6c-0.47,2.703-2.459,4.917-5.029,5.748v2.378 c0,1.158-0.942,2.1-2.1,2.1H9.217V24.401z">
                            </path>
                            <path fill="red" class="ptt-status-icon"
                                d="M9.367,15.668c1.527,0,2.765-1.238,2.765-2.765V5.265c0-1.527-1.238-2.765-2.765-2.765 S6.603,3.738,6.603,5.265v7.638C6.603,14.43,7.84,15.668,9.367,15.668z M14.655,12.91h-0.3c-0.33,0-0.614,0.269-0.631,0.598 c0,0,0,0-0.059,0.285c-0.41,1.997-2.182,3.505-4.298,3.505c-2.126,0-3.904-1.521-4.304-3.531C5.008,13.49,5.008,13.49,5.008,13.49 c-0.016-0.319-0.299-0.579-0.629-0.579h-0.3c-0.33,0-0.591,0.258-0.579,0.573c0,0,0,0,0.04,0.278 c0.378,2.599,2.464,4.643,5.076,4.978v3.562c0,0.33,0.27,0.6,0.6,0.6h0.3c0.33,0,0.6-0.27,0.6-0.6V18.73 c2.557-0.33,4.613-2.286,5.051-4.809c0.057-0.328,0.061-0.411,0.061-0.411C15.243,13.18,14.985,12.91,14.655,12.91z">
                            </path>
                        </svg>
                    </div>
                </span>
                <span style="padding-left: 10px;"> {{ recordingTime | date:'mm:ss' }}</span>
            </div>
            <span class="recording-indicator"
                style="text-align: end; padding-right: 20px; color: red;">Recording...</span>
        </div>
        <!-- <div *ngIf="isPreviewing && recordedAudioURL" class="preview-container after-record">
            <audio controlsList="nodownload" [src]="recordedAudioURL" controls></audio>
        </div>
        <div *ngIf="isPreviewing && recordedAudioURL" class="action-buttons">
            <button class="cancel-button" (click)="cancelRecording()">
                <svg width="20px" height="20px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                    <path fill="#000"
                        d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z" />
                </svg>
            </button>
        </div> -->
        <!--============== recording ======================-->
        <!-- -->
        <div class="chatInputDiv" [ngClass]="audioRecording ? 'd-block' : 'd-none'">
            <!-- <canvas  #waveformCanvasRef width="200" height="100"></canvas> -->
            <canvas #waveformCanvas width="180" height="32"></canvas>

        </div>

        <!-- *ngIf="isSendButtonVisible" -->
        <div class="bg-cls" [ngClass]="{
            'anime':isRecording
        }">
            <ng-container *ngIf="isSendButtonVisible">
                <!-- <ng-container *ngIf="audioRecording">
                <span (click)="stopRecording()">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" style="height: 33px; width: 30px;">
                        <circle cx="16" cy="16" r="14.75" fill="none" stroke="red" stroke-width="2.5"></circle>
                        <path class="iwt3stqw s79hpmcy ksz6vod1"
                            d="M20.65,21.69V10.25H17.31V21.69Zm-9.3-11.44V21.69h3.34V10.25Z" fill="red"></path>
                    </svg>
                </span>

                <span (click)="playRecording()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16px" height="18px" viewBox="0 0 16 18"
                        class="d7dzraxg">
                        <path
                            d="M15.05,8.39,2,.32a1,1,0,0,0-1.53.85V16.83A1,1,0,0,0,2,17.7L15,10.1A1,1,0,0,0,15.05,8.39Z"
                            fill="currentColor"></path>
                    </svg>
                </span>
            </ng-container> -->



                <div class="sendButton trfff fade-in btnww" id="sendButton"
                    (click)="sendMessage();isSendButtonClick=true">
                    <!-- <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                      id="OBJECTS" x="0px" y="0px" viewBox="0 0 50 50" enable-background="new 0 0 50 50" xml:space="preserve">
                      <g>
                          <g>
                              <path fill="#1B1C1C"
                                  d="M4.347,49.142c-0.41-0.406-0.565-1.014-0.39-1.576l7.347-23.584L5.324,2.386    c-0.17-0.615,0.049-1.273,0.556-1.663s1.198-0.433,1.75-0.11l37.708,22.082c0.476,0.279,0.77,0.787,0.776,1.338    c0.005,0.552-0.279,1.065-0.749,1.354L6.276,49.37c-0.558,0.342-1.269,0.303-1.785-0.098C4.44,49.231,4.392,49.188,4.347,49.142z     M9.381,5.276l5.071,18.313c0.081,0.29,0.076,0.598-0.014,0.886L8.197,44.509l33.295-20.428L9.381,5.276z" />
                          </g>
                          <g>
                              <path fill="#1B1C1C"
                                  d="M11.831,25.119c-0.285-0.285-0.461-0.679-0.46-1.113c0-0.867,0.705-1.569,1.571-1.568l31.604,0.042    c0.867,0.001,1.57,0.705,1.567,1.572c-0.001,0.867-0.704,1.568-1.571,1.567l-31.605-0.042    C12.505,25.577,12.115,25.401,11.831,25.119z" />
                          </g>
                      </g>
                    svg> -->
                    <!-- Generator: Adobe Illustrator 26.0.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
                    <svg version="1.1" id="Layer_1" width="20px" height="20px" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 24 24"
                        style="enable-background:new 0 0 24 24;" xml:space="preserve" fill="white">
                        <path d="M1.9,22.2c-0.5,0.2-0.9,0.1-1.3-0.1C0.2,21.8,0,21.4,0,20.9v-6.2L11,12L0,9.2V3.1c0-0.5,0.2-0.9,0.6-1.2
	C1,1.6,1.5,1.6,1.9,1.8l21.2,8.9C23.7,11,24,11.4,24,12c0,0.6-0.3,1-0.9,1.3L1.9,22.2z" />
                    </svg>

                    <!-- <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1"
                    id="Uploaded to svgrepo.com" viewBox="0 0 32 32" xml:space="preserve">
                    <style type="text/css">
                        .stone_een {
                            fill: blue;
                        }

                        .st0 {
                            fill: #0B1719;
                        }
                    </style>
                    <path class="stone_een"
                        d="M10.774,23.619l-1.625,5.691C9.06,29.164,9,28.992,9,28.794v-5.57l13.09-12.793L10.774,23.619z   M10.017,29.786c0.243-0.002,0.489-0.084,0.69-0.285l3.638-3.639l-2.772-1.386L10.017,29.786z M28.835,2.009L3.802,14.326  c-2.226,1.095-2.236,4.266-0.017,5.375l4.89,2.445L27.464,3.79c0.204-0.199,0.516-0.234,0.759-0.086  c0.326,0.2,0.396,0.644,0.147,0.935l-16.3,18.976l8.84,4.4c1.746,0.873,3.848-0.128,4.27-2.034l5.071-22.858  C30.435,2.304,29.588,1.639,28.835,2.009z" />
                </svg> -->
                </div>



            </ng-container>
            <!-- audio icon -->
            <ng-container *ngIf="!isSendButtonVisible">
                <!-- <div class="sendButton mik fade-in" id="sendButton" (click)="sendMessage();isSendButtonClick=true">
                    <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                        viewBox="0 0 19 26" height="28" width="21" preserveAspectRatio="xMidYMid meet" class=""
                        version="1.1" x="0px" y="0px" enable-background="new 0 0 19 26">
                        <title>ptt-status</title>
                        <path fill="transparent" class="ptt-status-background"
                            d="M9.217,24.401c-1.158,0-2.1-0.941-2.1-2.1v-2.366c-2.646-0.848-4.652-3.146-5.061-5.958L2.004,13.62 l-0.003-0.081c-0.021-0.559,0.182-1.088,0.571-1.492c0.39-0.404,0.939-0.637,1.507-0.637h0.3c0.254,0,0.498,0.044,0.724,0.125v-6.27 C5.103,2.913,7.016,1,9.367,1c2.352,0,4.265,1.913,4.265,4.265v6.271c0.226-0.081,0.469-0.125,0.723-0.125h0.3 c0.564,0,1.112,0.233,1.501,0.64s0.597,0.963,0.571,1.526c0,0.005,0.001,0.124-0.08,0.6c-0.47,2.703-2.459,4.917-5.029,5.748v2.378 c0,1.158-0.942,2.1-2.1,2.1H9.217V24.401z">
                        </path>
                        <path fill="#000" class="ptt-status-icon"
                            d="M9.367,15.668c1.527,0,2.765-1.238,2.765-2.765V5.265c0-1.527-1.238-2.765-2.765-2.765 S6.603,3.738,6.603,5.265v7.638C6.603,14.43,7.84,15.668,9.367,15.668z M14.655,12.91h-0.3c-0.33,0-0.614,0.269-0.631,0.598 c0,0,0,0-0.059,0.285c-0.41,1.997-2.182,3.505-4.298,3.505c-2.126,0-3.904-1.521-4.304-3.531C5.008,13.49,5.008,13.49,5.008,13.49 c-0.016-0.319-0.299-0.579-0.629-0.579h-0.3c-0.33,0-0.591,0.258-0.579,0.573c0,0,0,0,0.04,0.278 c0.378,2.599,2.464,4.643,5.076,4.978v3.562c0,0.33,0.27,0.6,0.6,0.6h0.3c0.33,0,0.6-0.27,0.6-0.6V18.73 c2.557-0.33,4.613-2.286,5.051-4.809c0.057-0.328,0.061-0.411,0.061-0.411C15.243,13.18,14.985,12.91,14.655,12.91z">
                        </path>
                    </svg>
                </div> -->
                <button *ngIf="!isMobile" (click)="toggleRecording()" class="mic-button">
                    <span *ngIf="!isRecording">
                        <div class="sendButton mik fade-in">
                            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                viewBox="0 0 19 26" height="28" width="21" preserveAspectRatio="xMidYMid meet" class=""
                                version="1.1" x="0px" y="0px" enable-background="new 0 0 19 26">
                                <title>ptt-status</title>
                                <path fill="transparent" class="ptt-status-background"
                                    d="M9.217,24.401c-1.158,0-2.1-0.941-2.1-2.1v-2.366c-2.646-0.848-4.652-3.146-5.061-5.958L2.004,13.62 l-0.003-0.081c-0.021-0.559,0.182-1.088,0.571-1.492c0.39-0.404,0.939-0.637,1.507-0.637h0.3c0.254,0,0.498,0.044,0.724,0.125v-6.27 C5.103,2.913,7.016,1,9.367,1c2.352,0,4.265,1.913,4.265,4.265v6.271c0.226-0.081,0.469-0.125,0.723-0.125h0.3 c0.564,0,1.112,0.233,1.501,0.64s0.597,0.963,0.571,1.526c0,0.005,0.001,0.124-0.08,0.6c-0.47,2.703-2.459,4.917-5.029,5.748v2.378 c0,1.158-0.942,2.1-2.1,2.1H9.217V24.401z">
                                </path>
                                <path fill="#000" class="ptt-status-icon"
                                    d="M9.367,15.668c1.527,0,2.765-1.238,2.765-2.765V5.265c0-1.527-1.238-2.765-2.765-2.765 S6.603,3.738,6.603,5.265v7.638C6.603,14.43,7.84,15.668,9.367,15.668z M14.655,12.91h-0.3c-0.33,0-0.614,0.269-0.631,0.598 c0,0,0,0-0.059,0.285c-0.41,1.997-2.182,3.505-4.298,3.505c-2.126,0-3.904-1.521-4.304-3.531C5.008,13.49,5.008,13.49,5.008,13.49 c-0.016-0.319-0.299-0.579-0.629-0.579h-0.3c-0.33,0-0.591,0.258-0.579,0.573c0,0,0,0,0.04,0.278 c0.378,2.599,2.464,4.643,5.076,4.978v3.562c0,0.33,0.27,0.6,0.6,0.6h0.3c0.33,0,0.6-0.27,0.6-0.6V18.73 c2.557-0.33,4.613-2.286,5.051-4.809c0.057-0.328,0.061-0.411,0.061-0.411C15.243,13.18,14.985,12.91,14.655,12.91z">
                                </path>
                            </svg>
                        </div>
                    </span>
                    <span *ngIf="isRecording">
                        <!-- <svg style="transform: translateY(-2px);" width="20px" height="20px"
                            xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                            <path
                                d="M0 128C0 92.7 28.7 64 64 64H320c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z" />
                        </svg> -->
                        <svg version="1.1" id="Layer_1" width="20px" height="20px" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 24 24"
                            style="enable-background:new 0 0 24 24; transform: translateY(-2px);" xml:space="preserve"
                            fill="#fff">
                            <path d="M1.9,22.2c-0.5,0.2-0.9,0.1-1.3-0.1C0.2,21.8,0,21.4,0,20.9v-6.2L11,12L0,9.2V3.1c0-0.5,0.2-0.9,0.6-1.2
	C1,1.6,1.5,1.6,1.9,1.8l21.2,8.9C23.7,11,24,11.4,24,12c0,0.6-0.3,1-0.9,1.3L1.9,22.2z" />
                        </svg>
                    </span>
                </button>


                <!-- <button *ngIf="isPreviewing && recordedAudioURL" class="send-button" (click)="sendAudioToAPI()">
                    <div class="sendButton trfff fade-in btnww">
                        <svg version="1.1" id="Layer_1" width="20px" height="20px" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 24 24"
                            style="enable-background:new 0 0 24 24;" xml:space="preserve">
                            <path d="M1.9,22.2c-0.5,0.2-0.9,0.1-1.3-0.1C0.2,21.8,0,21.4,0,20.9v-6.2L11,12L0,9.2V3.1c0-0.5,0.2-0.9,0.6-1.2
	C1,1.6,1.5,1.6,1.9,1.8l21.2,8.9C23.7,11,24,11.4,24,12c0,0.6-0.3,1-0.9,1.3L1.9,22.2z" />
                        </svg>
                    </div>
                </button> -->
            </ng-container>
        </div>

        <!-- <button (click)="startRecording()">Start Recording</button>
        <button (click)="stopRecording()">Stop Recording</button>

        <audio *ngIf="audioSrc" [src]="audioSrc" controls></audio> -->


        <!-- <ng-container>
            <span class="sendButton">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 35 35" class="">
                    <path
                        d="M17.5,0h0A17.51,17.51,0,0,1,35,17.5h0A17.51,17.51,0,0,1,17.5,35h0A17.51,17.51,0,0,1,0,17.5H0A17.51,17.51,0,0,1,17.5,0Z"
                        fill="currentColor"></path>
                    <path class="iwt3stqw s79hpmcy ksz6vod1"
                        d="M25.64,18.55,11.2,24.93a.86.86,0,0,1-1.13-.44.83.83,0,0,1-.06-.44l.48-4.11a1.36,1.36,0,0,1,1.24-1.19l7.51-.6a.16.16,0,0,0,.14-.16.16.16,0,0,0-.14-.14l-7.51-.6a1.36,1.36,0,0,1-1.24-1.19L10,12a.84.84,0,0,1,.74-.94.87.87,0,0,1,.45.06l14.44,6.38a.61.61,0,0,1,.31.79A.59.59,0,0,1,25.64,18.55Z"
                        fill="#fff"></path>
                </svg>
            </span>
        </ng-container> -->
    </div>
    <!---***********  Bottom Bar for Chat End -*********** -->
</div>



<div class="modal fade modal-bg-style-edit" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content border-0">
            <div class="modal-header edit-modal p-2">
                <button type="button" class="btn-close edit-close" data-bs-dismiss="modal" aria-label="Close"
                    (click)="ismsgFalse()"></button>
                <span class="modal-title edit-text" id="exampleModalLabel">Edit Message</span>
            </div>
            <div class="modal-body edit-body">
                <div class="edit-msg">
                    <div class="edit-msg-in position-relative">
                        {{ showFullMessage ? selectedMessage?.message : (selectedMessage?.message | slice:0:120) +
                        (selectedMessage?.message.length > 120 ? ' ...' : '') }}
                        <span style="color: #027eb5; cursor: pointer;" *ngIf="selectedMessage?.message.length > 80"
                            (click)="toggleMessage()">{{ showFullMessage
                            ? '' : 'Read more' }}</span>
                        <p class="m-0 msg-time" *ngIf="selectedMessage">
                            {{selectedMessage?.timestamp | date : 'h:mm a'}}
                            <svg viewBox="0 0 12 11" height="11" width="16" preserveAspectRatio="xMidYMid meet" class=""
                                fill="none">
                                <title>msg-check</title>
                                <path
                                    d="M11.1549 0.652832C11.0745 0.585124 10.9729 0.55127 10.8502 0.55127C10.7021 0.55127 10.5751 0.610514 10.4693 0.729004L4.28038 8.36523L1.87461 6.09277C1.8323 6.04622 1.78151 6.01025 1.72227 5.98486C1.66303 5.95947 1.60166 5.94678 1.53819 5.94678C1.407 5.94678 1.29275 5.99544 1.19541 6.09277L0.884379 6.40381C0.79128 6.49268 0.744731 6.60482 0.744731 6.74023C0.744731 6.87565 0.79128 6.98991 0.884379 7.08301L3.88047 10.0791C4.02859 10.2145 4.19574 10.2822 4.38194 10.2822C4.48773 10.2822 4.58929 10.259 4.68663 10.2124C4.78396 10.1659 4.86436 10.1003 4.92784 10.0156L11.5738 1.59863C11.6458 1.5013 11.6817 1.40186 11.6817 1.30029C11.6817 1.14372 11.6183 1.01888 11.4913 0.925781L11.1549 0.652832Z"
                                    fill="currentcolor"></path>
                            </svg>
                        </p>
                    </div>
                </div>
                <div class="d-flex align-items-center justify-content-between mt-3 border-line">
                    <div class="form-group w-100">
                        <input id="editText" class="form-control outn" type="text" [(ngModel)]="editMessage"
                            (keydown.enter)="submitEdit(closeBtn)" />
                    </div>

                    <div class="form-group" style="text-align: center;">
                        <button #closeBtn type="submit" class="btn edit-msg-update" data-bs-dismiss="modal"
                            aria-label="Close" (click)="editText(editMessage)">
                            <svg viewBox="0 0 24 24" height="24" width="24" preserveAspectRatio="xMidYMid meet"
                                version="1.1">
                                <title>checkmark-medium</title>
                                <path fill="white" d="M8,17.1l-5.2-5.2l-1.7,1.7l6.9,7L22.9,5.7L21.2,4L8,17.1z"></path>
                            </svg>
                        </button>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>


<div class="modal fade custom-modal" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content custom-modal-content">
            <div class="modal-body custom-modal-body">
                <h5 class="custom-modal-title">Delete message?</h5>
                <div class="custom-modal-actions">
                    <button type="button" class="btn custom-modal-btn" data-bs-dismiss="modal"
                        (click)="deleteSelectedMessage('everyOne')">Delete for everyone</button>
                    <button type="button" class="btn custom-modal-btn" data-bs-dismiss="modal"
                        (click)="deleteSelectedMessage('forMe')">Delete for me</button>
                    <button type="button" class="btn custom-modal-btn" data-bs-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal -->
<!-- <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-img">

        <div class="modal-header ">
            <h5 class="modal-title" id="exampleModalLabel">Modal Title</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body" style="padding: 0; pointer-events: auto;">
            <div class="modal-body text-center p-0">
                <img [src]="selectedImageUrl" alt="Preview" class="img-fluid "
                    style="max-height: 80vh; object-fit: contain;" />
            </div>
        </div>


    </div>
</div> -->



<!-- image poreview -->
<div [ngClass]="{
    'modal-animation' : isModalOpen
}" class="modal-overlay" (click)="closeModal()">
    <div class="d-flex align-items-center justify-content-between main-head">
        <div style="margin-top: 10px; margin-left: 15px;" class="d-flex align-items-center">
            <div class="position-relative" style="padding: 0 15px 0 13px;">
                <img class="logoImg-loader-2" alt="">
            </div>
            <div class="d-flex flex-column text-white">
                <span style="font-size: 14px;">You</span>
                <span style="color: #ffffff99; font-size: 13px;">{{ formattedTimee }}</span>
            </div>
        </div>
        <div class="d-flex column-gap-2" style="margin-right: 18px;" (click)="$event.stopPropagation()">
            <span class="close-button" (click)="closeModal()">
                <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                    height="24" width="24" preserveAspectRatio="xMidYMid meet" class="" fill="none">
                    <title fill="none">back-refreshed</title>
                    <path
                        d="M7.8248 13L12.7248 17.9C12.9248 18.1 13.0206 18.3333 13.0123 18.6C13.004 18.8667 12.8998 19.1 12.6998 19.3C12.4998 19.4833 12.2665 19.5792 11.9998 19.5875C11.7331 19.5958 11.4998 19.5 11.2998 19.3L4.6998 12.7C4.5998 12.6 4.52897 12.4917 4.4873 12.375C4.44564 12.2583 4.4248 12.1333 4.4248 12C4.4248 11.8667 4.44564 11.7417 4.4873 11.625C4.52897 11.5083 4.5998 11.4 4.6998 11.3L11.2998 4.69999C11.4831 4.51665 11.7123 4.42499 11.9873 4.42499C12.2623 4.42499 12.4998 4.51665 12.6998 4.69999C12.8998 4.89999 12.9998 5.13749 12.9998 5.41249C12.9998 5.68749 12.8998 5.92499 12.6998 6.12499L7.8248 11H18.9998C19.2831 11 19.5206 11.0958 19.7123 11.2875C19.904 11.4792 19.9998 11.7167 19.9998 12C19.9998 12.2833 19.904 12.5208 19.7123 12.7125C19.5206 12.9042 19.2831 13 18.9998 13H7.8248Z"
                        fill="#FFFFFF" fill-opacity="0.6"></path>
                </svg>
            </span>
            <span class="close-button" (click)="downloadImage()">
                <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                    height="24" width="24" preserveAspectRatio="xMidYMid meet" class="" fill="none">
                    <title fill="none">download-refreshed</title>
                    <path
                        d="M12.3536 15.6464C12.1583 15.8417 11.8417 15.8417 11.6464 15.6464L7.69481 11.6948C7.30912 11.3091 7.30886 10.6801 7.68772 10.2877C8.0761 9.88547 8.72424 9.87424 9.11962 10.2696L11 12.15V5C11 4.44772 11.4477 4 12 4C12.5523 4 13 4.44772 13 5V12.15L14.8804 10.2696C15.2758 9.87424 15.9239 9.88547 16.3123 10.2877C16.6911 10.6801 16.6909 11.3091 16.3052 11.6948L12.3536 15.6464ZM6 20C5.45 20 4.97917 19.8042 4.5875 19.4125C4.19583 19.0208 4 18.55 4 18V16C4 15.4477 4.44772 15 5 15C5.55228 15 6 15.4477 6 16V18H18V16C18 15.4477 18.4477 15 19 15C19.5523 15 20 15.4477 20 16V18C20 18.55 19.8042 19.0208 19.4125 19.4125C19.0208 19.8042 18.55 20 18 20H6Z"
                        fill="#FFFFFF" fill-opacity="0.6"></path>
                </svg>
            </span>
            <span class="close-button" (click)="closeModal()">
                <svg xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                    height="24" width="24" preserveAspectRatio="xMidYMid meet" class="" fill="none">
                    <title fill="none">close-refreshed</title>
                    <path
                        d="M11.9998 13.4L7.0998 18.3C6.91647 18.4833 6.68314 18.575 6.3998 18.575C6.11647 18.575 5.88314 18.4833 5.6998 18.3C5.51647 18.1167 5.4248 17.8833 5.4248 17.6C5.4248 17.3167 5.51647 17.0833 5.6998 16.9L10.5998 12L5.6998 7.09999C5.51647 6.91665 5.4248 6.68332 5.4248 6.39999C5.4248 6.11665 5.51647 5.88332 5.6998 5.69999C5.88314 5.51665 6.11647 5.42499 6.3998 5.42499C6.68314 5.42499 6.91647 5.51665 7.0998 5.69999L11.9998 10.6L16.8998 5.69999C17.0831 5.51665 17.3165 5.42499 17.5998 5.42499C17.8831 5.42499 18.1165 5.51665 18.2998 5.69999C18.4831 5.88332 18.5748 6.11665 18.5748 6.39999C18.5748 6.68332 18.4831 6.91665 18.2998 7.09999L13.3998 12L18.2998 16.9C18.4831 17.0833 18.5748 17.3167 18.5748 17.6C18.5748 17.8833 18.4831 18.1167 18.2998 18.3C18.1165 18.4833 17.8831 18.575 17.5998 18.575C17.3165 18.575 17.0831 18.4833 16.8998 18.3L11.9998 13.4Z"
                        fill="#FFFFFF" fill-opacity="0.6"></path>
                </svg>
            </span>
        </div>
    </div>
    <div class="modal-contentt" (click)="$event.stopPropagation()">
        <img [src]="selectedImageSrc" alt="Full Image"
            style="max-width: 100%; max-height: 80vh; object-fit: contain;" />
    </div>
</div>